<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>HfTL-Club - Infoscreen</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="../common/css/bootstrap.min.css">
    <link rel="stylesheet" href="../common/css/bootstrap.cyborg.min.css">
    <link rel="stylesheet" href="../common/css/style.css">
    

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="../common/js/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="../common/js/jquery.slimscroll.min.js"></script>
    <script type="text/javascript" src="../common/js/jquery.kinetic.min.js"></script>
    <script type="text/javascript" src="../common/js/bootstrap.min.js"></script>

</head>
<body>
    <div class="container">
        <div id="modules">
            <div id="module_drinks">
                <!-- Getränkekarten View -->
                <div class="row">
                    <div class="page-header">
                        <h1>HfTL-Club <small><span class="glyphicon glyphicon-glass"></span> Getränkekarte</small></h1>
                    </div>
                </div>

                <div class="row" id="catlist"></div>


                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-default panel-pizza">
                            <div class="panel-heading">Hinweise</div>
                            <div class="panel-body">
                                Für unsere Gläser erheben wir 1 € Pfand, für Weizengläser sind es 2 €.<br />
                                Zusatzstoffe: <span id="additives"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="module_text">
                <!-- Freitext View -->
                <div class="row">
                    <div class="page-header">
                        <h1>HfTL-Club <small><span class="glyphicon glyphicon-info-sign"></span> Informationen</small></h1>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="jumbotron">
                            <h1>Hello, world!</h1>
                            <p>This is a simple hero unit, a simple jumbotron-style component for calling extra attention to featured content or information...</p>
                        </div>
                    </div>
                </div>
            </div>


            <div id="module_highlights">
                <!-- Image/Next Highlights View -->
                <div class="row">
                    <div class="page-header">
                        <h1>HfTL-Club <small><span class="glyphicon glyphicon-star"></span> Highlights</small></h1>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div style="text-align:center;">
                            <img id="media_picture" style="height:800px" src="C:\Clouds\Teamdrive3\HfTL-Club_Werbung\beachparty\beachparty.png" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        // JS Block for module handling
        var activeTimelineModule = null;

        $(function moduleLogic() {
            //first: hide all modules:
            hideAllModules();

            //second: load timeline from database...
            var dataUrl = "json.php?mode=timeline";

            $.ajax({
                type: "get",
                url: dataUrl,
                dataType: "json",
                success: processTimelineData,
                error: function (o, c, m) { alert(m); }
            });

            function processTimelineData(data)
            {
                var next = false;
                $.each(data.timelineEntries, function (i, entry) {
                    // is this module currently played?
                    if (entry.id == activeTimelineModule.id) {
                        // so set next module to play!
                        next = true;
                    }

                    //is this module choosen to play next?
                    if (next)
                    {
                        activeTimelineModule = entry;
                        next = false; // oder gibt es ein break für die $.each???
                    }

                });

                //what is the type of the module?
                switchToModule(activeTimelineModule.type);

                //load the module-data to the corresponding module:

            }

            //DEBUG: start with drinks:
            switchToModule("drinks");

        });

        function switchToModule(moduleName)
        {
            hideAllModules();
            $("#module_" + moduleName).show();
        }

        function hideAllModules() {
            $("#module_drinks").hide();
            $("#module_text").hide();
            $("#module_highlights").hide();
        }
    </script>


    <script type="text/javascript">
        // JS Block für Gertänkekarte-logik
        $(function orderLogic() {
            var dataUrl = "json.php?mode=drinks";

            $.ajax({
                type: "get",
                url: dataUrl,
                dataType: "json",
                success: processData,
                error: function (o, c, m) { alert(m); }
            });


            function processData(data) {
                //the view container
                var $catlist = $("#catlist");
				
				//go through categories
                $.each(data.categories, function (i, cat) {
                    
                    //initialize category box
                    var $catbox = $("<div>")
                    	.addClass("col-xs-12 col-md-6");
                    
                    //initialize table
                    var $table = $("<table>")
                    	.addClass("table");
                    
                   
                    //go through drinks and make table
                    $.each(cat.drinks, function (i, drink) {
                    	
                    	$table.append(
                    		$("<tr>")
                    			.append(
                    				$("<td>")
                    					.append(
                    						$("<span>").text(drink.name)
                    					)
										.append(
											$("<sup>").text(drink.additives.join(", "))
                    					)
                    			)
                    			.append(
                    				$("<td>").text(parsePrice(drink.price))
                    			)
                    	);
                    				
                    });
                    
                    
                    //build the category box
                    $catbox.append(
                    	$("<div>")
                    		.addClass("row")
                    		.append(
                    			$("<div>")
                    				.addClass("col-md-12")
                    				.append(
                    					$("<div>")
											.addClass("panel panel-default panel-pizza")
											.append(
												$("<div>")
													.addClass("panel-heading")
													.text(cat.name)
											)
											.append($table)
                    				)
                    		)
                    );
                    

					//append category box to view container
                    $catlist.append($catbox);
                    
                    
                    
                    //build additives list for footer
                    var $add_text = "";
                    
                    var len = data.additives.length;
                    $.each(data.additives, function (i, item) {
                    	$add_text += item.index + " - " + item.name;
                    	if(i < len - 1) {
                    		$add_text += ", ";
                    	}
                    });
                    
                    $("#additives").text($add_text);
                    
                    
                    
                });

            }
            
            
            //parse float value to price string: 1.5 to 1,50 EUR
            function parsePrice(price){
				retval = parseFloat(price, 10).toFixed(2).toString()
				retval = retval.replace(".", ",");
				retval += " EUR";
				
				return retval;
            }
            
            

		});

    </script>
</body>
</html>
