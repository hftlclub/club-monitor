<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>HfTL-Club - Infoscreen</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="../common/css/bootstrap.min.css">
    <link rel="stylesheet" href="../common/css/bootstrap.cyborg.min.css">
    <link rel="stylesheet" href="../common/css/style.css">
    

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="../common/js/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="../common/js/jquery.slimscroll.min.js"></script>
    <script type="text/javascript" src="../common/js/jquery.kinetic.min.js"></script>
    <script type="text/javascript" src="../common/js/bootstrap.min.js"></script>

</head>
<body>
    <div class="container">
        <!-- Getränkekarten View -->
        <div class="row">
            <div class="page-header">
                <h1>HfTL-Club <small><span class="glyphicon glyphicon-glass"></span> Getränkekarte</small></h1>
            </div>
        </div>

        <div class="row" id="catlist"></div>
        
        
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default panel-pizza">
                    <div class="panel-heading">Hinweise</div>
                    <div class="panel-body">
                        Für unsere Gläser erheben wir 1 € Pfand, für Weizengläser sind es 2 €.<br />
                        Zusatzstoffe: 1 - Zucker, 2 - Hefebakterien,...
                    </div>
                </div>
            </div>
        </div>
        

        <!-- Freitext View -->
        <div class="row">
            <div class="page-header">
                <h1>HfTL-Club <small><span class="glyphicon glyphicon-info-sign"></span> Informationen</small></h1>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="panel panel-default panel-pizza">
                    <div class="panel-heading">Auswahl</div>
                    <div class="list-group" id="pizza-selection">
                    </div>
                </div>
            </div>
            <div class="col-12">
                <div class="panel panel-default panel-pizza">
                    <div class="panel-heading">Bestellung</div>
                    <div class="panel-body">
                        <form role="form" id="cart-form">
                            <div class="form-group">
                                <label for="input-cart-name">Name</label>
                                <input id="input-cart-name" class="form-control" placeholder="Namen eingeben" onfocus="jsKeyboard.focus(this);clean(this);placeholder=''" ontouchstart="jsKeyboard.focus(this);clean(this);placeholder=''">
                            </div>
                            <div class="form-group">
                                <label>Ausgewählt</label>
                                <div class="list-group" id="cart-items">
                                </div>
                            </div>
                            <input type="submit" class="btn btn-success btn-lg btn-block" value="Jetzt zahlungspflichtig bestellen">
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script type="text/javascript">

        $(function orderLogic() {
            var dataUrl = "json.php?mode=drinks";
            var orderUrl = "post_order.php";
            var orders = [];

            $.ajax({
                type: "get",
                url: dataUrl,
                dataType: "json",
                success: processData,
                error: function (o, c, m) { alert(m); }
            });


            function processData(data) {
                //the view container
                var $catlist = $("#catlist");
				
				//go through categories
                $.each(data.categories, function (i, cat) {
                    
                    //initialize category box
                    var $catbox = $("<div>")
                    	.addClass("col-xs-12 col-md-6");
                    
                    //initialize table
                    var $table = $("<table>")
                    	.addClass("table");
                    
                   
                    //go through drinks and make table
                    $.each(cat.drinks, function (i, drink) {
                    	
                    	$table.append(
                    		$("<tr>")
                    			.append(
                    				$("<td>")
                    					.append(
                    						$("<span>").text(drink.name)
                    					)
                    					.append(
                    						$("<sup>").text(drink.additives.join(", "))
                    					)
                    			)
                    			.append(
                    				$("<td>").text(parsePrice(drink.price))
                    			)
                    	);
                    				
                    });
                    
                    
                    //build the category box
                    $catbox.append(
                    	$("<div>")
                    		.addClass("row")
                    		.append(
                    			$("<div>")
                    				.addClass("col-md-12")
                    				.append(
                    					$("<div>")
											.addClass("panel panel-default panel-pizza")
											.append(
												$("<div>")
													.addClass("panel-heading")
													.text(cat.name)
											)
											.append($table)
                    				)
                    		)
                    );
                    

					//append category box to view container
                    $catlist.append($catbox);
                });

            }
            
            
            //parse float value to price string: 1.5 to 1,50 EUR
            function parsePrice(price){
				retval = parseFloat(price, 10).toFixed(2).toString()
				retval = retval.replace(".", ",");
				retval += " EUR";
				
				return retval;
            }
            
            

		});

    </script>
</body>
</html>
